metadata={systemName:"bazTestBroker",displayName:"Example Broker",description:"An example broker that accesses JSONPlaceholder.",configuration:{ServiceURL:{displayName:"JSONPlaceholder Service URL",type:"string",value:"https://jsonplaceholder.typicode.com"},mySpecialSetting:{displayName:"normal news",type:"string",value:"https://bbc.co.uk"}}},ondescribe=async function({configuration:e}){postSchema({objects:{todo:{displayName:"TODO",description:"Manages a TODO list",properties:{id:{displayName:"ID",type:"number"},userId:{displayName:"User ID",type:"number"},title:{displayName:"Title",type:"string"},completed:{displayName:"Completed",type:"boolean"}},methods:{get:{displayName:"Get TODO",type:"read",inputs:["id"],outputs:["id","userId","title","completed"]},getItems:{displayName:"Get TODOs",type:"list",outputs:["id","userId","title","completed"]}}}}})},onexecute=async function({objectName:e,methodName:t,parameters:o,properties:s,configuration:a,schema:r}){switch(e){case"todo":await async function(e,t,o,s){switch(e){case"get":await function(e,t){return new Promise((o,s)=>{var a=new XMLHttpRequest,r=t.ServiceURL;if(a.onreadystatechange=function(){try{if(4!==a.readyState)return;if(200!==a.status)throw new Error("Failed with status "+a.status);var e=JSON.parse(a.responseText);postResult({id:e.id,userId:e.userId,title:e.title,completed:e.completed}),o()}catch(e){s(e)}},console.log("baz todo log"),console.log(r+"/todos"+encodeURIComponent(e.id.toString())),"number"!=typeof e.id)throw new Error('properties["id"] is not of type number');a.open("GET",r+"/todos"+encodeURIComponent(e.id)),a.setRequestHeader("test","test value"),a.send()})}(t,s);break;case"getItems":await function(e,t){return new Promise((e,o)=>{var s=new XMLHttpRequest,a=t.ServiceURL;s.onreadystatechange=function(){try{if(4!==s.readyState)return;if(200!==s.status)throw new Error("Failed with status "+s.status);var t=JSON.parse(s.responseText);postResult(t.map(e=>({id:e.id,userId:e.userId,title:e.title,completed:e.completed}))),e()}catch(e){o(e)}},console.log("baz todos log"),console.log(a+"/todos"),s.open("GET",a+"/todos"),s.send()})}(0,s);break;default:throw new Error("The method "+e+" is not supported.")}}(t,s,0,a);break;default:throw new Error("The object "+e+" is not supported.")}};
//# sourceMappingURL=index.js.map
