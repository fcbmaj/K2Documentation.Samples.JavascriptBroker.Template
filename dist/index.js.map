{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import \"@k2oss/k2-broker-core\";\r\nmetadata = {\r\n  \"systemName\": \"JsspITest_Multipart_File_Upload\",\r\n  \"displayName\": \"JavaScript Service Provider Multipart Form Data Execute File Upload Test\",\r\n  \"description\": \"This is for test purposes.\"\r\n};\r\nondescribe = function () {\r\n  console.log('test');\r\n  postSchema({\r\n    objects: {\r\n      \"JsspITest_Test1\": {\r\n        displayName: \"JsspITest_Test1\",\r\n        description: \"JsspITest_Test1.description\",\r\n        isActive: true,\r\n         properties: {\r\n           \"file1\": { displayName: \"File1\", description: \"Input File Prop\", type: \"attachment\" },\r\n           \"result\": { displayName: \"Result\", description: \"Result\", type: \"string\" }\r\n        },\r\n        methods: {\r\n         \"UploadFile\": {\r\n           displayName: \"Upload File\",\r\n           description: \"Upload File\",\r\n           type: \"read\",\r\n           //inputs: [\"file1\"],\r\n           outputs: [\"result\"]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  });\r\n};\r\nonexecute = function ({objectName, methodName, parameters, properties}) {\r\n  switch (objectName) {\r\n    case \"JsspITest_Test1\":\r\n      executeXHRTest(methodName, parameters, properties);\r\n      break;\r\n    default:\r\n      throw new Error(\"the object \" + objectName + \" is not supported.\");\r\n  }\r\n};\r\nfunction executeXHRTest(methodName, parameters, properties) {\r\n  switch (methodName) {\r\n    case \"UploadFile\":\r\n      executeUploadFileMethod(parameters, properties);\r\n      break;\r\n    default: throw new Error(\"The method \" + methodName + \" is not supported.\");\r\n  }\r\n}\r\nfunction executeUploadFileMethod(parameters, properties) {\r\n    \r\n  var oauthToken = \"77NUAGA2JjHNIm3Jo8D3rE3BDDBdl4wI\";\r\n  var file1 = \"Adobe Sign/TestTwo.docx\";\r\n\r\n  var form = new FormData();\r\n  // form.append('attributes', JSON.stringify({\"name\": properties[file1].filename, \"parent\": {\"id\": \"0\"}})); //IMPORTANT\r\n  form.append(\"attributes\", JSON.stringify({\"name\": \"TestTwo.docx\", \"parent\": {\"id\": \"0\"},\"content_created_at\": \"2012-12-12T10:53:43-08:00\", \"content_modified_at\": \"2012-12-12T10:53:43-08:00\"}));\r\n  form.append('file', properties[file1].content);\r\n\r\n      \r\n  var xhr = new XMLHttpRequest();\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState !== 4) return;\r\n    if (xhr.status !== 201) throw new Error(\"Failed with status \" + JSON.stringify(xhr.response) +\". Details: \" + xhr.responseText);\r\n        \r\n    postResult({\"result\" :\"File uploaded successfully\" + JSON.stringify(xhr.response)}); \r\n    \r\n  };\r\n  xhr.open(\"POST\", 'https://upload.box.com/api/2.0/files/content', true);\r\n  xhr.setRequestHeader('Authorization', 'Bearer ' + oauthToken);\r\n  xhr.send(form);    \r\n}"],"names":["metadata","ondescribe","console","log","postSchema","objects","displayName","description","isActive","properties","type","methods","outputs","onexecute","objectName","methodName","parameters","oauthToken","file1","form","FormData","append","JSON","stringify","content","xhr","XMLHttpRequest","onreadystatechange","readyState","status","Error","response","responseText","postResult","open","setRequestHeader","send","executeUploadFileMethod","executeXHRTest"],"mappings":"AACAA,SAAW,YACK,8CACC,uFACA,8BAEjBC,WAAa,WACXC,QAAQC,IAAI,QACZC,WAAW,CACTC,QAAS,iBACY,CACjBC,YAAa,kBACbC,YAAa,8BACbC,UAAU,EACTC,WAAY,OACD,CAAEH,YAAa,QAASC,YAAa,kBAAmBG,KAAM,qBAC7D,CAAEJ,YAAa,SAAUC,YAAa,SAAUG,KAAM,WAEnEC,QAAS,YACM,CACZL,YAAa,cACbC,YAAa,cACbG,KAAM,OAENE,QAAS,CAAC,iBAOrBC,UAAY,UAAUC,WAACA,EAADC,WAAaA,EAAbC,WAAyBA,EAAzBP,WAAqCA,WACjDK,OACD,mBAOT,SAAwBC,EAAYC,EAAYP,UACtCM,OACD,cAMT,SAAiCC,EAAYP,OAEvCQ,EAAa,mCACbC,EAAQ,0BAERC,EAAO,IAAIC,SAEfD,EAAKE,OAAO,aAAcC,KAAKC,UAAU,MAAS,sBAA0B,IAAO,wBAA2B,gDAAoD,+BAClKJ,EAAKE,OAAO,OAAQZ,EAAWS,GAAOM,aAGlCC,EAAM,IAAIC,eACdD,EAAIE,mBAAqB,cACA,IAAnBF,EAAIG,eACW,MAAfH,EAAII,OAAgB,MAAM,IAAIC,MAAM,sBAAwBR,KAAKC,UAAUE,EAAIM,UAAW,cAAgBN,EAAIO,cAElHC,WAAW,QAAW,6BAA+BX,KAAKC,UAAUE,EAAIM,cAG1EN,EAAIS,KAAK,OAAQ,gDAAgD,GACjET,EAAIU,iBAAiB,gBAAiB,UAAYlB,GAClDQ,EAAIW,KAAKjB,GA1BLkB,CAAwBrB,EAAYP,uBAEvB,IAAIqB,MAAM,cAAgBf,EAAa,uBAXpDuB,CAAevB,EAAYC,EAAYP,uBAGjC,IAAIqB,MAAM,cAAgBhB,EAAa"}